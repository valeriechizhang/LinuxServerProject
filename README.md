# LinuxServerProject

**Site Info:**</br>
IP address: 34.210.208.166</br>
SSH port: 2200</br>
URL: http://ec2-34-210-208-166.us-west-2.compute.amazonaws.com</br>

Note: Login functions only work propertly when visit the site using the URL, and not when use the IP address.</br>

</br>

**Tools & Software:**</br>
AWS Lightsail, Ubuntu, Flask, Apache2, mod_wsgi, virtualenv, git, python-pip, postgresql</br>

</br>

**References:**</br>
How To Deploy a Flask Application on an Ubuntu VPS: https://www.digitalocean.com/community/tutorials/how-to-deploy-a-flask-application-on-an-ubuntu-vps</br>
Initial Server Setup with Ubuntu 12.04: https://www.digitalocean.com/community/tutorials/initial-server-setup-with-ubuntu-12-04</br>

</br>

**Notes to Reviewer:**</br>

Passphrase: None (passphrase was left empty)

grader</br>

-----BEGIN RSA PRIVATE KEY-----</br>
MIIEpAIBAAKCAQEAtqGqAa0nYVoqhImmySmEJzE83lpWx7ooD1zgrPwt0VQViQhy
sWlaXAIQ/9nhdc4cCAdaUv6eL1vLuv1U5IZgxjXLU1pYJ7CcXD5jUTKRHyD29q1L
1VtmV174jRZwO8DQgpbSIRibjRiTSbJXHJCmHb5PAMfm5IiHmO+bd+v3mpK1IGTp
UXzsSNElY/73qg9Z5+aJOmxpypxup4K2pRdHPZsJUkUjOTwXVcpULAaHzPqpCuEW
QxWvQkLI4286sepwBfrLYuPJA/LuUKs/RuBHxqTJGpT49DA2at2mubKxE/r63pIC
frb5LOlii9UKUdft6QLlOPHRWourm3gt/QFUKQIDAQABAoIBAAHZsXdC4dtCppuh
KWdwXD5paUx3bdmoMS+2qTAXff9Y8r7orwDNKHU2MCXndzlSVUZfjLK6ka+5Jl9G
oc2O7vwTH3RAvhPo3iyxFSCFeqLuGpJ1PwdyXZ8U/z+usoRod7RbAtYDAdB0J0nf
3LIVZRl4DCTd4aD/ISCTjOeyJFgUkA9XHl/890juj70SaeVMfghewwUsHlXlRjfV
GeMSFj7Axc3jU/wmCqLjqCJGGstE3YYd4QRvOzlm/4pcIn2mV1PDFXye1CumvZyU
F6FbA1SyuGz2EkN1Hj5u0WaW73cfu6+cHoQj+Jejiy6ZdH6SOaBCj/jbb3uZspyf
/HymHeECgYEA3JGVqu/WW3UYYmsPByr4FZmXDgiO2Tmy8mww3s5O1rDE+9gR8i59
NTJ9eM07/Gc5t4D5ozE5ddaOxnamjohcA1Qt18aC4xemFT4RPOkO7/N/D8VTGjwK
Aj0iYHo7OwdkA4nRczFSvMCXfVeMP7DUgq/Xd8J1rw+lms68Ze5amE8CgYEA0/f+
Y7zkiGJueqG+/PHVNhgHO/3DiZ7xJvxabufBw4Dgogq6LijOxgUdbSHIlzSJHqdv
foPihkjrKf9qRbDySfS59s8l/aQ88He6UHV5LMFkhQWk3iFBTpGQKGdu9UFVHJiu
xrhiaUvhxYjbpZtWnrLtpr8x+pFiIN485R0RtgcCgYEAuDefmTTXA2u5AfoIgyQQ
L3on/0CGjkbyfiZ+aphEoGrjGrRLyMmrKVMSGGLRRu2v9uNxnCrwosqgVIGkekbJ
Er6ryxuxFZoazIMaQpUkNKRZ6wITdkXO1i/ZFlsAPTze+1WP6XW4dI0l+Tm1mTxH
QR88BnoTcDLRTYp9L2TzpWECgYEAlLzJCe2LI1SGl5CV9uIvLWUQ9nyr0A7ywtuD
DZ2cbnYpqisC188UwQjnzCNPoSJhMVxmNQ2QT5AtS+wJA1wVt+V89H4I94FerZIl
771uyQPvaBQ8yw3kyKAF2wQxbPFqKsXMpm7Nx3tSsozFK+DjmDqP3lj9VgjcJZos
esy6F9MCgYAPCu/6CSDXq7d+DEvlybrfIBhnDlRwezi5eq0OMSXTe4b7jTGkq8Bb
02YHTKGKSq0LCBUDF6NvHnIcYjudoKJfHvxxtxisn/WwashSxJ9bMyeJrsWkwy+b
2z1mi0vFhFaYkzx+gWnJq8FqHOuD1qduuJgCsXu+Dxv58wzYQ+MN5w==</br>
-----END RSA PRIVATE KEY-----
</br>

grader.pub</br>

ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC2oaoBrSdhWiqEiabJKYQnMTzeWlbHuigPXOCs/C3RVBWJCHKxaVpcAhD/2eF1zhwIB1pS/p4vW8u6/VTkhmDGNctTWlgnsJxcPmNRMpEfIPb2rUvVW2ZXXviNFnA7wNCCltIhGJuNGJNJslcckKYdvk8Ax+bkiIeY75t36/eakrUgZOlRfOxI0SVj/veqD1nn5ok6bGnKnG6ngralF0c9mwlSRSM5PBdVylQsBofM+qkK4RZDFa9CQsjjbzqx6nAF+sti48kD8u5Qqz9G4EfGpMkalPj0MDZq3aa5srET+vrekgJ+tvks6WKL1QpR1+3pAuU48dFai6ubeC39AVQp Chi@ZhangChis-MacBook-Pro.local


### Steps on Configuration:
#### 1. Create AWS Lightsail using Ubuntu, and then create and attach a static IP address to the instance.
#### 2. Connect to the instance using SSH
#### 3. Update all currently installed packages
sudo apt-get update
sudo apt-get upgrade
sudo apt-get dist-upgrade (if there are still packages needed for upgrading)
#### 4. Change the SSH port from 22 to 2200
1. Use 'sudo nano /etc/ssh/sshd_config' and then change 'Port 22' to 'Port 2200', save and quit.
2. Reload SSH using 'sudo service ssh restart'

#### 5. Configure the Uncomplicated Firewall (UFW)
1. On the Lightsail management console for the isntance, under the network tab, add two new custome application: UDP -> 123 and TCP 2200
2. Use below bash code to configure firewall inside SSH:
'sudo ufw default deny incoming'
'sudo ufw default allow outgoing'
'sudo ufw allow ssh'
'sudo ufw allow www'
'sudo ufw allow 2200/tcp'
'sudo ufw allow 80/tcp'
'sudo ufw allow 123/udp'
'sudo ufw delete allow 22'
'sudo ufw enable'

#### 6. Set up user 'grader'
1. Use 'sudo adduser grader' to create grader as a user
2. Use 'visudo' and addl line 'grader ALL=(ALL:ALL) ALL'
3. Generate a public key on another machine, and create a file owned by grader contains the public key: /grader/.ssh/publicKey

#### 7. Set up Apache2
1. Use 'sudo apt-get install libapache2-mod-wsgi python-dev' to install the package
2. Enable wsgi using 'sudo a2enmod wsgi'
3. Set up the web application file inside /var/www/html
4. Install python packages: 
  'sudo apt-get install python-pip'
  'sudo pip install virtualenv'
  'sudo pip install Flask'
  etc.
  
5. Create notecards.wsgi inside /var/www/html
6. Configure the NoteCards app using 'sudo nano /etc/apache2/sites-available/NoteCards.conf', save and quit
7. Add line 'WSGIScriptAlias / /var/www/html/notecards.wsgi' to 000-default.conf 

#### 8. Set up the database
1. Use 'sudo apt-get install postgresql' to install PostgresSQL
2. Use 'sudo su - postgres' to switch to user postgres
3. Use 'psql' to start up PostgreSQL
4. Create catalog as a new user using 'CREATE USER catalog WITH PASSWORD 'catalog';'
5. Give permission to catalog using 'ALTER ROLE catalog CREATEDB;' and 'ALTER ROLE catalog LOGIN;'
6. Create a new database using CREATE DATABASE catalog WITH OWNER catalog;'
7. Use 'create_engine('postgreslq://catalog:catalog@localhost/catalog')' to connect with the database in application files inside /var/www/html/NoteCards/
8. Set up database catalog by 'sudo python database_setup.py' and 'sudo python fillup.py'

#### 9. Set up the application
1. Use below commands to start and refresh the application on the server:
'sudo service apache2 reload'
'sudo service apache2 restart'


